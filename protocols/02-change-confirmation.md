# Протокол 02 — Система подтверждения изменений

Статус: DONE

Цель: безопасное изменение настроек с возможностью отката.

Сделано:
- Таймер 20 сек, кнопки подтверждения/отмены, автооткат.
- Восстановление состояния слайдеров, сохранение профиля в XML.
- Защита от рекурсивных событий UI, адаптивные цвета и перезапуск таймера.

Примечания:
- См. соответствующие компоненты в `crates/mondis-panel*/`.

## Хронология изменений

- 2025-08-29 23:04 (+10:00): Панель подтверждения переведена в нижний плавающий оверлей.
  - Использованы `gtk::Overlay` + `gtk::Revealer` — панель появляется поверх контента снизу, не сдвигая основной layout.
  - Таймер обратного отсчёта 20 сек: текст обновляется каждую секунду, по тайм-ауту значения яркости откатываются, слайдеры восстанавливаются.
  - Обработчики Confirm/Cancel теперь скрывают панель через `confirm_revealer.set_reveal_child(false)` и корректно сохраняют/откатывают профиль.
  - Рефактор замыканий: `start_confirmation_timer` обёрнут в `Rc<dyn Fn(Vec<DisplayInfo>)>`, внутри timeout-замыкания используется клон `confirm_revealer` для исключения ошибок перемещения (`E0507`).
